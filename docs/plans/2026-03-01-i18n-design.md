# i18n Design — Visio Mobile v2

**Date:** 2026-03-01
**Status:** Approved

## Goal

Replace hardcoded fr/en translation maps with a complete i18n system using shared JSON files, supporting 6 languages across Desktop, Android, and iOS.

## Languages

| Code | Language |
|------|----------|
| en   | English (fallback) |
| fr   | Français |
| de   | Deutsch |
| es   | Español |
| it   | Italiano |
| nl   | Nederlands |

## Architecture

### Shared Translation Files

```
i18n/
  en.json
  fr.json
  de.json
  es.json
  it.json
  nl.json
```

Flat key format with dot-separated namespaces:

```json
{
  "app.title": "Visio Mobile",
  "home.join": "Join",
  "call.mute": "Mute",
  "settings.language": "Language",
  "lang.en": "English",
  "lang.fr": "Français"
}
```

### Loading Per Platform

**Desktop (React/Vite):** Static import of JSON files. `t(key)` function looks up current language map, falls back to `en.json`.

**Android (Kotlin/Compose):** JSON files copied to `assets/i18n/` at build time. `Strings.kt` loads via `context.assets.open()`, parses with `org.json.JSONObject`. Same `t(key)` with en fallback.

**iOS (SwiftUI):** JSON files added to Xcode bundle. `Strings.swift` loads via `Bundle.main.url(forResource:)`, parses with `JSONDecoder`. Same `t(key)` with en fallback.

### Language Detection

1. Check `SettingsStore.language` (persisted user choice)
2. If null: detect system language (`navigator.language` / `Locale.getDefault()` / `Locale.current`)
3. Match to supported languages (e.g. `fr-FR` → `fr`)
4. If unsupported: fallback to `en`

## What Changes

1. Delete inline translation maps from `App.tsx`, `Strings.kt`, `Strings.swift`
2. Replace with JSON loading + `t(key)` function
3. Fix remaining hardcoded strings (app title, language names, accessibility labels)
4. Add 4 new languages (de, es, it, nl)
5. Update language picker dropdown to list all 6 languages

## What Does NOT Change

- Rust error messages stay in English
- SettingsStore API unchanged (`language` field already exists)
- `t(key)` function signature stays the same
